<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Hello World</title>
  <style>
    :root {
      color-scheme: light;
    }

    body {
      font-family: Arial, Helvetica, sans-serif;
      margin: 2rem;
      background: #f6f7fb;
      color: #1f1f1f;
    }

    .page-title {
      font-size: 2.5rem;
      margin-bottom: 2rem;
      font-weight: 700;
    }

    .gallery {
      display: flex;
      flex-wrap: wrap;
      gap: 2rem;
      align-items: flex-start;
    }

    .inputs {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      flex: 0 0 220px;
    }

    .outputs {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .frame {
      width: 220px;
      border: 1px solid #d7d9e0;
      border-radius: 12px;
      padding: 0.75rem;
      background: #ffffff;
      box-shadow: 0 2px 6px rgba(15, 23, 42, 0.08);
    }

    .output-frame {
      width: 260px;
    }

    .frame figcaption {
      font-size: 0.95rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.75rem;
    }

    .frame img,
    .frame canvas {
      width: 100%;
      height: auto;
      display: block;
      border-radius: 8px;
    }

    .frame canvas {
      background: #f0f1f6;
    }

    .frame figcaption .step-toggle {
      font-size: 0.75rem;
      font-weight: 600;
      color: #3d45d0;
      background: rgba(61, 69, 208, 0.08);
      border: 1px solid rgba(61, 69, 208, 0.2);
      border-radius: 999px;
      padding: 0.25rem 0.75rem;
      cursor: pointer;
      transition: background 0.2s ease, border-color 0.2s ease;
    }

    .frame figcaption .step-toggle:hover,
    .frame figcaption .step-toggle:focus {
      outline: none;
      background: rgba(61, 69, 208, 0.15);
      border-color: rgba(61, 69, 208, 0.35);
    }

    .frame figcaption .step-toggle:focus-visible {
      box-shadow: 0 0 0 3px rgba(61, 69, 208, 0.35);
    }

    .processing-panel {
      margin-top: 0.75rem;
      padding: 0.75rem;
      background: #f4f5fb;
      border: 1px solid #e0e2f1;
      border-radius: 10px;
    }

    .processing-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 0.75rem;
    }

    .step-frame {
      border: 1px solid #d7d9e0;
      border-radius: 10px;
      padding: 0.5rem;
      background: #ffffff;
      box-shadow: 0 1px 4px rgba(15, 23, 42, 0.05);
    }

    .step-frame figcaption {
      font-size: 0.8rem;
      font-weight: 600;
      margin-bottom: 0.35rem;
      display: block;
    }

    .step-frame canvas {
      width: 100%;
      border-radius: 6px;
      background: #f0f1f6;
    }

    .upload-control {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      align-items: stretch;
    }

    .upload-button-label {
      display: inline-flex;
      justify-content: center;
      align-items: center;
      padding: 0.5rem 0.75rem;
      border: 1px dashed #a2a5b5;
      border-radius: 8px;
      background: #f9f9fc;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.2s ease, border-color 0.2s ease;
      text-align: center;
      width: 100%;
    }

    .upload-button-label:hover {
      background: #eef0ff;
      border-color: #7378d1;
    }

    #custom-image-input {
      display: none;
    }

    .upload-hint {
      font-size: 0.8rem;
      color: #4f5466;
      margin: 0;
      text-align: center;
    }

    .upload-control img {
      margin-top: 0.25rem;
    }
  </style>
</head>
<body>
  <h1 class="page-title">Codex Playground</h1>
  <section class="gallery">
    <div class="inputs">
      <figure class="frame">
        <figcaption>1. Mouse Input</figcaption>
        <img id="original-img" src="input_mouse.jpeg" alt="Mouse input sample">
      </figure>
      <figure class="frame">
        <figcaption>2. Coaster Input</figcaption>
        <img id="coaster-img" src="input_coaster.jpeg" alt="Coaster input sample">
      </figure>
      <figure class="frame">
        <figcaption>3. Remote Input</figcaption>
        <img id="remote-img" src="input_remote.jpeg" alt="Remote input sample">
      </figure>
      <figure class="frame" id="custom-input-frame">
        <figcaption>4. Upload Input</figcaption>
        <div class="upload-control">
          <label class="upload-button-label" for="custom-image-input">Choose Image</label>
          <input id="custom-image-input" type="file" accept="image/*">
          <p class="upload-hint">Upload a photo to detect and outline the main object.</p>
          <img id="custom-img" alt="Uploaded input preview" hidden>
        </div>
      </figure>
    </div>
    <div class="outputs">
      <figure class="frame output-frame">
        <figcaption>
          <span>Mouse Output</span>
          <button
            class="step-toggle"
            type="button"
            data-step-toggle="mouse-processing-steps"
            data-show-label="Show steps"
            data-hide-label="Hide steps"
            aria-expanded="false"
          >
            Show steps
          </button>
        </figcaption>
        <canvas id="output-canvas"></canvas>
        <div id="mouse-processing-steps" class="processing-panel" hidden>
          <div class="processing-grid">
            <figure class="step-frame">
              <figcaption>Step 1. Prepared Frame</figcaption>
              <canvas id="mouse-step-resized"></canvas>
            </figure>
            <figure class="step-frame">
              <figcaption>Step 2. Grayscale</figcaption>
              <canvas id="mouse-step-gray"></canvas>
            </figure>
            <figure class="step-frame">
              <figcaption>Step 3. Blurred Gray</figcaption>
              <canvas id="mouse-step-blur"></canvas>
            </figure>
            <figure class="step-frame">
              <figcaption>Step 4. Object Mask</figcaption>
              <canvas id="mouse-step-mask"></canvas>
            </figure>
            <figure class="step-frame">
              <figcaption>Step 5. Binary Contours</figcaption>
              <canvas id="mouse-step-contours"></canvas>
            </figure>
          </div>
        </div>
      </figure>
      <figure class="frame output-frame">
        <figcaption>Coaster Output</figcaption>
        <canvas id="coaster-output-canvas"></canvas>
      </figure>
      <figure class="frame output-frame">
        <figcaption>Remote Output</figcaption>
        <canvas id="remote-output-canvas"></canvas>
      </figure>
      <figure class="frame output-frame" id="custom-output-frame" hidden>
        <figcaption>Upload Output</figcaption>
        <canvas id="custom-output-canvas"></canvas>
      </figure>
    </div>
  </section>
  <main id="app"></main>
  <script defer src="https://docs.opencv.org/4.x/opencv.js"></script>
  <script defer src="main.js"></script>
</body>
</html>
